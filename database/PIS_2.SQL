-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
-- -----------------------------------------------------
-- Schema pis_2
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema pis_2
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `pis_2` DEFAULT CHARACTER SET latin1 ;
USE `pis_2` ;

-- -----------------------------------------------------
-- Table `pis_2`.`ORGANIZATION`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`ORGANIZATION` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`ORGANIZATION` (
  `ORGANIZATIONID` INT(11) NOT NULL,
  `ORGANIZATIONNAME` VARCHAR(100) NOT NULL,
  `DTJOINED` DATE NOT NULL,
  `ACTIVE` INT(1) NOT NULL COMMENT '1 - ACTIVE\\\\n0 - NOPE',
  PRIMARY KEY (`ORGANIZATIONID`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`SUBORGANIZATION`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`SUBORGANIZATION` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`SUBORGANIZATION` (
  `SUBORGANIZATIONID` INT(11) NOT NULL COMMENT '1 = HEAD OFFICE',
  `ORGANIZATIONID` INT(11) NOT NULL,
  `DTJOINED` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `ACTIVE` INT(1) NULL DEFAULT '1',
  PRIMARY KEY (`SUBORGANIZATIONID`, `ORGANIZATIONID`),
  INDEX `IDX_1` (`ORGANIZATIONID` ASC) VISIBLE,
  CONSTRAINT `fk_SUBORGANIZATION_1`
    FOREIGN KEY (`ORGANIZATIONID`)
    REFERENCES `pis_2`.`ORGANIZATION` (`ORGANIZATIONID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`CALENDAR`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`CALENDAR` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`CALENDAR` (
  `CALENDARID` INT(11) NOT NULL,
  `DATE` DATE NOT NULL,
  `TIMESTART` TIME NOT NULL,
  `TIMEEND` TIME NOT NULL,
  `SUBORGANIZATIONID` INT(11) NOT NULL,
  PRIMARY KEY (`CALENDARID`),
  INDEX `IDX` (`CALENDARID` ASC, `SUBORGANIZATIONID` ASC, `DATE` ASC, `TIMESTART` ASC, `TIMEEND` ASC) VISIBLE,
  INDEX `fk_CALENDAR_1_idx` (`SUBORGANIZATIONID` ASC) VISIBLE,
  CONSTRAINT `fk_CALENDAR_1`
    FOREIGN KEY (`SUBORGANIZATIONID`)
    REFERENCES `pis_2`.`SUBORGANIZATION` (`SUBORGANIZATIONID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`USER`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`USER` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`USER` (
  `USERID` INT(11) NOT NULL,
  `USERNAME` VARCHAR(50) NOT NULL,
  `PASSWORD` CHAR(128) NOT NULL,
  `FIRSTNAME` VARCHAR(60) NOT NULL,
  `MIDDLENAME` VARCHAR(60) NULL DEFAULT NULL,
  `LASTNAME` VARCHAR(60) NOT NULL,
  `DOB` VARCHAR(45) NOT NULL,
  `SEX` TINYINT(2) NOT NULL COMMENT 'FEMALE - 0\\nMALE - 1',
  `DTUPDATED` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`USERID`, `USERNAME`, `FIRSTNAME`, `LASTNAME`),
  UNIQUE INDEX `USERNAME_UNIQUE` (`USERNAME` ASC) VISIBLE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`PACKAGE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`PACKAGE` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`PACKAGE` (
  `PACKAGEID` INT(11) NOT NULL,
  `PACKAGENAME` VARCHAR(50) NOT NULL,
  `SUBORGANIZATIONID` INT(11) NOT NULL,
  `DTCREATED` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `TOTALSESSION` INT(10) NOT NULL COMMENT '0 = UNLIMITED - FOR TRIAL OR FREE SESSION',
  `DURATION` INT(11) NOT NULL COMMENT 'APPROX DURATION FOR EACH SESSION IN MINUTES\\n',
  `DTSTART` DATE NULL DEFAULT NULL,
  `DTEND` DATE NULL DEFAULT NULL COMMENT 'leave blank for unknown end date\\n',
  `DEFAULTPRICE` FLOAT NOT NULL DEFAULT '0',
  `ACTIVE` INT(1) NOT NULL DEFAULT '1',
  PRIMARY KEY (`PACKAGEID`, `PACKAGENAME`, `SUBORGANIZATIONID`, `DTCREATED`),
  INDEX `fk_PACKAGE_1_idx` (`SUBORGANIZATIONID` ASC) VISIBLE,
  CONSTRAINT `fk_PACKAGE_1`
    FOREIGN KEY (`SUBORGANIZATIONID`)
    REFERENCES `pis_2`.`SUBORGANIZATION` (`SUBORGANIZATIONID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`CALENDAR_DETAIL`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`CALENDAR_DETAIL` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`CALENDAR_DETAIL` (
  `CALENDARDETAILID` INT(11) NOT NULL,
  `CALENDARID` INT(11) NOT NULL,
  `TRAINER` INT(11) NOT NULL,
  `CLIENT` INT(11) NOT NULL,
  `STATUS` INT(5) NOT NULL COMMENT '1 = REQUEST\\n2 = APPROVED\\n3 = CANCELLED\\n4 = REJECTED',
  `DTUPDATED` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `PACKAGEID` INT(11) NOT NULL,
  PRIMARY KEY (`CALENDARDETAILID`),
  INDEX `IDX1` (`CALENDARID` ASC, `TRAINER` ASC, `CLIENT` ASC, `STATUS` ASC) VISIBLE,
  INDEX `fk_CALENDAR_DETAIL_2_idx` (`TRAINER` ASC) VISIBLE,
  INDEX `fk_CALENDAR_DETAIL_3_idx` (`CLIENT` ASC) VISIBLE,
  INDEX `fk_CALENDAR_DETAIL_4_idx` (`PACKAGEID` ASC) VISIBLE,
  CONSTRAINT `fk_CALENDAR_DETAIL_1`
    FOREIGN KEY (`CALENDARID`)
    REFERENCES `pis_2`.`CALENDAR` (`CALENDARID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CALENDAR_DETAIL_2`
    FOREIGN KEY (`TRAINER`)
    REFERENCES `pis_2`.`USER` (`USERID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CALENDAR_DETAIL_3`
    FOREIGN KEY (`CLIENT`)
    REFERENCES `pis_2`.`USER` (`USERID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CALENDAR_DETAIL_4`
    FOREIGN KEY (`PACKAGEID`)
    REFERENCES `pis_2`.`PACKAGE` (`PACKAGEID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`RF_EVENTTYPE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`RF_EVENTTYPE` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`RF_EVENTTYPE` (
  `EVENTTYPE` INT(11) NOT NULL COMMENT '1 = Public Holiday\\n2 = Corporate Event\\n3 = etc',
  `DESCRIPTION` VARCHAR(100) NOT NULL,
  `AVAILABILITY` INT(1) NOT NULL COMMENT '0 = not available\\n1 = available',
  PRIMARY KEY (`EVENTTYPE`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`CALENDAR_EVENT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`CALENDAR_EVENT` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`CALENDAR_EVENT` (
  `CALENDAREVENTID` INT(11) NOT NULL,
  `CALENDARID` INT(11) NOT NULL,
  `EVENTTYPEID` INT(11) NOT NULL,
  `DTSTART` DATE NOT NULL,
  `DTEND` DATE NULL DEFAULT NULL,
  PRIMARY KEY (`CALENDAREVENTID`),
  INDEX `fk_CALENDAR_EVENT_1_idx` (`CALENDARID` ASC) VISIBLE,
  INDEX `fk_CALENDAR_EVENT_2_idx` (`EVENTTYPEID` ASC) VISIBLE,
  CONSTRAINT `fk_CALENDAR_EVENT_1`
    FOREIGN KEY (`CALENDARID`)
    REFERENCES `pis_2`.`CALENDAR` (`CALENDARID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CALENDAR_EVENT_2`
    FOREIGN KEY (`EVENTTYPEID`)
    REFERENCES `pis_2`.`RF_EVENTTYPE` (`EVENTTYPE`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`RF_CANCELCATEGORY`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`RF_CANCELCATEGORY` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`RF_CANCELCATEGORY` (
  `CANCELCATEGORYID` INT(11) NOT NULL COMMENT '1 = SICK\\n2 = ACCIDENT\\n3 = DEATH\\n4 = MINOR\\n5 = ETC',
  `DESCRIPTION` VARCHAR(60) NOT NULL,
  PRIMARY KEY (`CANCELCATEGORYID`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`CANCEL_DETAIL`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`CANCEL_DETAIL` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`CANCEL_DETAIL` (
  `CANCELID` INT(11) NOT NULL,
  `CANCELCATEGORYID` INT(11) NOT NULL,
  `DTENTERED` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `NOTES` VARCHAR(100) NULL DEFAULT NULL,
  PRIMARY KEY (`CANCELID`),
  INDEX `fk_CANCEL_DETAIL_1_idx` (`CANCELCATEGORYID` ASC) VISIBLE,
  CONSTRAINT `fk_CANCEL_DETAIL_1`
    FOREIGN KEY (`CANCELCATEGORYID`)
    REFERENCES `pis_2`.`RF_CANCELCATEGORY` (`CANCELCATEGORYID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`RF_RULESTYPE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`RF_RULESTYPE` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`RF_RULESTYPE` (
  `RULESTYPEID` INT(11) NOT NULL,
  `DESCRIPTION` VARCHAR(60) NULL DEFAULT NULL COMMENT '1 = CANCELLATION POLICY\\n2 = PROMO (IF ANY)',
  PRIMARY KEY (`RULESTYPEID`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`CUSTOM_RULES`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`CUSTOM_RULES` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`CUSTOM_RULES` (
  `SUBORGANIZATIONID` INT(11) NOT NULL,
  `RULESTYPEID` INT(11) NOT NULL,
  `RULES` VARCHAR(100) NOT NULL COMMENT 'CANCELLATION : WITHIN CERTAIN PERIOD - FREE CANCELLATION\\n',
  PRIMARY KEY (`SUBORGANIZATIONID`, `RULESTYPEID`),
  INDEX `fk_CUSTOM_RULES_1_idx` (`RULESTYPEID` ASC) VISIBLE,
  CONSTRAINT `fk_CUSTOM_RULES_1`
    FOREIGN KEY (`RULESTYPEID`)
    REFERENCES `pis_2`.`RF_RULESTYPE` (`RULESTYPEID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`RF_CONTACTTYPE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`RF_CONTACTTYPE` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`RF_CONTACTTYPE` (
  `CONTACTTYPE` SMALLINT(6) NOT NULL COMMENT '1. Address\\n2. Mobile Phone\\n3. email\\n4. Home Phone\\n5. Work Phone\\n30. Bank Name\\n31. Bank Account\\n32. Name in Bank acc',
  `DESCRIPTION` VARCHAR(60) NULL DEFAULT NULL,
  PRIMARY KEY (`CONTACTTYPE`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`ORGANIZATION_CONTACT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`ORGANIZATION_CONTACT` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`ORGANIZATION_CONTACT` (
  `ORGANIZATIONID` INT(11) NOT NULL,
  `PIC` INT(11) NOT NULL,
  `CONTACTTYPE` SMALLINT(6) NOT NULL,
  `DTSTART` DATE NOT NULL,
  PRIMARY KEY (`ORGANIZATIONID`, `PIC`, `CONTACTTYPE`, `DTSTART`),
  INDEX `fk_ORGANIZATION_CONTACT_1_idx` (`PIC` ASC) VISIBLE,
  INDEX `fk_ORGANIZATION_CONTACT_3_idx` (`CONTACTTYPE` ASC) VISIBLE,
  CONSTRAINT `fk_ORGANIZATION_CONTACT_1`
    FOREIGN KEY (`PIC`)
    REFERENCES `pis_2`.`USER` (`USERID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ORGANIZATION_CONTACT_2`
    FOREIGN KEY (`ORGANIZATIONID`)
    REFERENCES `pis_2`.`ORGANIZATION` (`ORGANIZATIONID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ORGANIZATION_CONTACT_3`
    FOREIGN KEY (`CONTACTTYPE`)
    REFERENCES `pis_2`.`RF_CONTACTTYPE` (`CONTACTTYPE`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`PACKAGE_TRANSACTION`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`PACKAGE_TRANSACTION` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`PACKAGE_TRANSACTION` (
  `PACKAGEID` INT(11) NOT NULL,
  `SALES` INT(11) NOT NULL COMMENT 'who did the sales',
  `CLIENT` INT(11) NOT NULL,
  `DTPURCHASED` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `PRICEPURCHASED` FLOAT NOT NULL COMMENT 'Purchased price - in case different from default price\\n',
  PRIMARY KEY (`PACKAGEID`, `SALES`, `CLIENT`, `DTPURCHASED`),
  INDEX `fk_PACKAGE_TRANSACTION_2_idx` (`CLIENT` ASC) VISIBLE,
  INDEX `fk_PACKAGE_TRANSACTION_3_idx` (`SALES` ASC) VISIBLE,
  CONSTRAINT `fk_PACKAGE_TRANSACTION_1`
    FOREIGN KEY (`PACKAGEID`)
    REFERENCES `pis_2`.`PACKAGE` (`PACKAGEID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_PACKAGE_TRANSACTION_2`
    FOREIGN KEY (`CLIENT`)
    REFERENCES `pis_2`.`USER` (`USERID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_PACKAGE_TRANSACTION_3`
    FOREIGN KEY (`SALES`)
    REFERENCES `pis_2`.`USER` (`USERID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`RF_ROLE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`RF_ROLE` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`RF_ROLE` (
  `ROLEID` INT(11) NOT NULL,
  `ROLEDESCRIPTION` VARCHAR(60) NOT NULL COMMENT '1 = God\\n2 = ORGANIZATION ADMIN/OWNER\\n3 = SUBORGANIZATION ADMIN\\n4 = TRAINER\\n5 = CLIENT',
  PRIMARY KEY (`ROLEID`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`SCHEDULE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`SCHEDULE` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`SCHEDULE` (
  `USERID` INT(11) NOT NULL,
  `DATESCHEDULED` DATE NOT NULL,
  `TIMESTART` DATETIME NOT NULL,
  `TIMEEND` DATETIME NOT NULL,
  PRIMARY KEY (`USERID`, `DATESCHEDULED`),
  CONSTRAINT `fk_SCHEDULE_1`
    FOREIGN KEY (`USERID`)
    REFERENCES `pis_2`.`USER` (`USERID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`SERVICE_LOG`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`SERVICE_LOG` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`SERVICE_LOG` (
  `SERVICEID` INT(11) NOT NULL COMMENT 'Actual log for ',
  `CALENDARDETAILID` INT(11) NOT NULL,
  `DTTIMESTART` DATETIME NOT NULL,
  `DTTIMEEND` DATETIME NOT NULL,
  `TRAINER` INT(11) NOT NULL COMMENT 'In case requested trainer is unavailable and replaced',
  PRIMARY KEY (`SERVICEID`),
  INDEX `IDX1` (`CALENDARDETAILID` ASC, `SERVICEID` ASC) VISIBLE,
  INDEX `fk_SERVICE_LOG_2_idx` (`TRAINER` ASC) VISIBLE,
  CONSTRAINT `fk_SERVICE_LOG_1`
    FOREIGN KEY (`CALENDARDETAILID`)
    REFERENCES `pis_2`.`CALENDAR_DETAIL` (`CALENDARDETAILID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_SERVICE_LOG_2`
    FOREIGN KEY (`TRAINER`)
    REFERENCES `pis_2`.`USER` (`USERID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`SUBORGANIZATION_CONTACT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`SUBORGANIZATION_CONTACT` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`SUBORGANIZATION_CONTACT` (
  `SUBORGANIZATIONID` INT(11) NOT NULL,
  `PIC` INT(11) NOT NULL,
  `CONTACTTYPE` SMALLINT(6) NOT NULL,
  `CONTACTVALUE` VARCHAR(200) NULL DEFAULT NULL,
  `DTSTART` DATE NOT NULL,
  `ACTIVE` INT(1) NOT NULL DEFAULT '1',
  PRIMARY KEY (`SUBORGANIZATIONID`, `PIC`, `CONTACTTYPE`, `DTSTART`),
  INDEX `fk_SUBORGANIZATION_CONTACT_2_idx` (`PIC` ASC) VISIBLE,
  INDEX `fk_SUBORGANIZATION_CONTACT_3_idx` (`CONTACTTYPE` ASC) VISIBLE,
  CONSTRAINT `fk_SUBORGANIZATION_CONTACT_1`
    FOREIGN KEY (`SUBORGANIZATIONID`)
    REFERENCES `pis_2`.`SUBORGANIZATION` (`SUBORGANIZATIONID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_SUBORGANIZATION_CONTACT_2`
    FOREIGN KEY (`PIC`)
    REFERENCES `pis_2`.`USER` (`USERID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_SUBORGANIZATION_CONTACT_3`
    FOREIGN KEY (`CONTACTTYPE`)
    REFERENCES `pis_2`.`RF_CONTACTTYPE` (`CONTACTTYPE`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`USER_CONTACT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`USER_CONTACT` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`USER_CONTACT` (
  `USERID` INT(11) NOT NULL,
  `CONTACTTYPE` SMALLINT(6) NOT NULL,
  `CONTACTVALUE` VARCHAR(200) NOT NULL,
  `DTSTART` DATE NOT NULL,
  PRIMARY KEY (`USERID`, `CONTACTTYPE`),
  INDEX `fk_USER_CONTACT_1_idx` (`CONTACTTYPE` ASC) VISIBLE,
  CONSTRAINT `FK_USER_CONTACT`
    FOREIGN KEY (`USERID`)
    REFERENCES `pis_2`.`USER` (`USERID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_USER_CONTACT_1`
    FOREIGN KEY (`CONTACTTYPE`)
    REFERENCES `pis_2`.`RF_CONTACTTYPE` (`CONTACTTYPE`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`USER_ROLE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`USER_ROLE` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`USER_ROLE` (
  `USERID` INT(11) NOT NULL,
  `ROLEID` INT(11) NOT NULL,
  PRIMARY KEY (`USERID`, `ROLEID`),
  INDEX `fk_USER_ROLE_2_idx` (`ROLEID` ASC) VISIBLE,
  CONSTRAINT `fk_USER_ROLE_1`
    FOREIGN KEY (`USERID`)
    REFERENCES `pis_2`.`USER` (`USERID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_USER_ROLE_2`
    FOREIGN KEY (`ROLEID`)
    REFERENCES `pis_2`.`RF_ROLE` (`ROLEID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `pis_2`.`USER_SUBORGANIZATION`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `pis_2`.`USER_SUBORGANIZATION` ;

CREATE TABLE IF NOT EXISTS `pis_2`.`USER_SUBORGANIZATION` (
  `USERID` INT(11) NOT NULL,
  `SUBORGANIZATIONID` INT(11) NOT NULL,
  `DTJOINED` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `ACTIVE` INT(1) NOT NULL DEFAULT '1',
  INDEX `IDX1` (`USERID` ASC, `SUBORGANIZATIONID` ASC) VISIBLE,
  INDEX `fk_USER_SUBORGANIZATION_2_idx` (`SUBORGANIZATIONID` ASC) VISIBLE,
  CONSTRAINT `fk_USER_SUBORGANIZATION_1`
    FOREIGN KEY (`USERID`)
    REFERENCES `pis_2`.`USER` (`USERID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_USER_SUBORGANIZATION_2`
    FOREIGN KEY (`SUBORGANIZATIONID`)
    REFERENCES `pis_2`.`SUBORGANIZATION` (`SUBORGANIZATIONID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
